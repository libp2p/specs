<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="610px" preserveAspectRatio="none" style="width:785px;height:610px;background:#FFFFFF;" version="1.1" viewBox="0 0 785 610" width="785px" zoomAndPan="magnify"><defs><filter height="300%" id="f13yzhtc059i0y" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;" x1="308" x2="308" y1="54.6094" y2="375.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="308" x2="308" y1="375.4219" y2="417.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="308" x2="308" y1="417.2578" y2="552.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="437" x2="437" y1="54.6094" y2="375.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="437" x2="437" y1="375.4219" y2="417.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="437" x2="437" y1="417.2578" y2="552.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="282" y="51.5332">Initiator</text><ellipse cx="308" cy="21" fill="#FEFECE" filter="url(#f13yzhtc059i0y)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="296" x2="320" y1="35" y2="35"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="282" y="565.8457">Initiator</text><ellipse cx="308" cy="584.9219" fill="#FEFECE" filter="url(#f13yzhtc059i0y)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="296" x2="320" y1="598.9219" y2="598.9219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="399" y="51.5332">Responder</text><ellipse cx="437" cy="21" fill="#FEFECE" filter="url(#f13yzhtc059i0y)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="425" x2="449" y1="35" y2="35"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="399" y="565.8457">Responder</text><ellipse cx="437" cy="584.9219" fill="#FEFECE" filter="url(#f13yzhtc059i0y)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="425" x2="449" y1="598.9219" y2="598.9219"/><rect fill="#EEEEEE" filter="url(#f13yzhtc059i0y)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="778" x="0" y="85.7852"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="778" y1="85.7852" y2="85.7852"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="778" y1="88.7852" y2="88.7852"/><rect fill="#EEEEEE" filter="url(#f13yzhtc059i0y)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="206" x="286" y="74.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188" x="292" y="92.1045">Initial multistream handshake</text><polygon fill="#A80036" points="319,127.3125,309,131.3125,319,135.3125,315,131.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="436" y1="131.3125" y2="131.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="325" y="126.4561">/multistream/1.0.0</text><polygon fill="#A80036" points="425,157.6641,435,161.6641,425,165.6641,429,161.6641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="308" x2="431" y1="161.6641" y2="161.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="315" y="156.8076">/multistream/1.0.0</text><rect fill="#EEEEEE" filter="url(#f13yzhtc059i0y)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="778" x="0" y="190.8398"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="778" y1="190.8398" y2="190.8398"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="778" y1="193.8398" y2="193.8398"/><rect fill="#EEEEEE" filter="url(#f13yzhtc059i0y)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="188" x="295" y="179.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="170" x="301" y="197.1592">Negotiate security protocol</text><polygon fill="#A80036" points="425,237.3672,435,241.3672,425,245.3672,429,241.3672" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="308" x2="431" y1="241.3672" y2="241.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="315" y="236.5107">/tls/1.0.0</text><path d="M84,219.0156 L84,245.0156 L299,245.0156 L299,229.0156 L289,219.0156 L84,219.0156 " fill="#FBFB77" filter="url(#f13yzhtc059i0y)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M289,219.0156 L289,229.0156 L299,229.0156 L289,219.0156 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="90" y="237.5107">Initiator proposes TLS for security</text><polygon fill="#A80036" points="319,277.7188,309,281.7188,319,285.7188,315,281.7188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="436" y1="281.7188" y2="281.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="325" y="276.8623">na</text><path d="M442,259.3672 L442,285.3672 L675,285.3672 L675,269.3672 L665,259.3672 L442,259.3672 " fill="#FBFB77" filter="url(#f13yzhtc059i0y)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M665,259.3672 L665,269.3672 L675,269.3672 L665,259.3672 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="448" y="277.8623">Responder does not support TLS yet</text><polygon fill="#A80036" points="425,318.0703,435,322.0703,425,326.0703,429,322.0703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="308" x2="431" y1="322.0703" y2="322.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="315" y="317.2139">/noise</text><path d="M125,299.7188 L125,325.7188 L299,325.7188 L299,309.7188 L289,299.7188 L125,299.7188 " fill="#FBFB77" filter="url(#f13yzhtc059i0y)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M289,299.7188 L289,309.7188 L299,309.7188 L289,299.7188 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="131" y="318.2139">Initiator falls back to Noise</text><polygon fill="#A80036" points="319,358.4219,309,362.4219,319,366.4219,315,362.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="436" y1="362.4219" y2="362.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="325" y="357.5654">/noise</text><path d="M442,340.0703 L442,366.0703 L762,366.0703 L762,350.0703 L752,340.0703 L442,340.0703 " fill="#FBFB77" filter="url(#f13yzhtc059i0y)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M752,340.0703 L752,350.0703 L762,350.0703 L752,340.0703 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="448" y="358.5654">Responder supports Noise, echoes back protocol id</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="331" y="400.8408">Noise handshake</text><rect fill="#EEEEEE" filter="url(#f13yzhtc059i0y)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="778" x="0" y="438.4336"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="778" y1="438.4336" y2="438.4336"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="778" y1="441.4336" y2="441.4336"/><rect fill="#EEEEEE" filter="url(#f13yzhtc059i0y)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="203" x="287.5" y="427.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185" x="293.5" y="444.7529">Negotiate stream multiplexer</text><polygon fill="#A80036" points="425,484.9609,435,488.9609,425,492.9609,429,488.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="308" x2="431" y1="488.9609" y2="488.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="315" y="484.1045">/mplex/1.0.0</text><path d="M5,466.6094 L5,492.6094 L299,492.6094 L299,476.6094 L289,466.6094 L5,466.6094 " fill="#FBFB77" filter="url(#f13yzhtc059i0y)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M289,466.6094 L289,476.6094 L299,476.6094 L289,466.6094 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="11" y="485.1045">Initiator proposes mplex for stream multiplexing</text><polygon fill="#A80036" points="319,525.3125,309,529.3125,319,533.3125,315,529.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="436" y1="529.3125" y2="529.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="325" y="524.4561">/mplex/1.0.0</text><path d="M442,506.9609 L442,532.9609 L764,532.9609 L764,516.9609 L754,506.9609 L442,506.9609 " fill="#FBFB77" filter="url(#f13yzhtc059i0y)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M754,506.9609 L754,516.9609 L764,516.9609 L754,506.9609 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="448" y="525.4561">Responder supports mplex, echoes back protocol id</text><!--MD5=[ca9d8fe20dc5092bf7596596f664122f]
@startuml
skinparam backgroundColor white

entity Initiator
entity Responder

== Initial multistream handshake ==

Responder -> Initiator: /multistream/1.0.0
Initiator -> Responder: /multistream/1.0.0

== Negotiate security protocol ==

Initiator -> Responder: /tls/1.0.0
note left: Initiator proposes TLS for security

Responder -> Initiator: na
note right: Responder does not support TLS yet

Initiator -> Responder: /noise
note left: Initiator falls back to Noise

Responder -> Initiator: /noise
note right: Responder supports Noise, echoes back protocol id

... Noise handshake ...

== Negotiate stream multiplexer ==

Initiator -> Responder: /mplex/1.0.0
note left: Initiator proposes mplex for stream multiplexing

Responder -> Initiator: /mplex/1.0.0
note right: Responder supports mplex, echoes back protocol id


@enduml

PlantUML version 1.2022.0(Tue Jan 11 17:16:42 CET 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>